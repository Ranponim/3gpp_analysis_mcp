# ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™” ê¶Œê³ ì‚¬í•­

## ðŸ“Š ê¶Œìž¥ ì¸ë±ìŠ¤ ìƒì„±

### 1. ê¸°ë³¸ ì¸ë±ìŠ¤

```sql
-- ì‹œê°„ ë²”ìœ„ + NE ë³µí•© ì¸ë±ìŠ¤ (ê°€ìž¥ ì¤‘ìš”)
CREATE INDEX CONCURRENTLY idx_summary_datetime_ne
ON summary (datetime, ne);

-- ì…€ ID + ì‹œê°„ ë³µí•© ì¸ë±ìŠ¤
CREATE INDEX CONCURRENTLY idx_summary_cellid_datetime
ON summary (cellid, datetime);

-- PEG ì´ë¦„ + ì‹œê°„ ë³µí•© ì¸ë±ìŠ¤
CREATE INDEX CONCURRENTLY idx_summary_peg_name_datetime
ON summary (peg_name, datetime);
```

### 2. ê³ ì„±ëŠ¥ ë³µí•© ì¸ë±ìŠ¤

```sql
-- ìµœì í™”ëœ ë³µí•© ì¸ë±ìŠ¤ (ëª¨ë“  ì£¼ìš” í•„í„° ì»¬ëŸ¼ í¬í•¨)
CREATE INDEX CONCURRENTLY idx_summary_composite
ON summary (ne, cellid, datetime, peg_name);

-- í˜¸ìŠ¤íŠ¸ ê¸°ë°˜ ì¡°íšŒìš© ì¸ë±ìŠ¤
CREATE INDEX CONCURRENTLY idx_summary_host_datetime
ON summary (host, datetime);
```

## ðŸ”§ ì¿¼ë¦¬ ìµœì í™” íŒ¨í„´

### 1. WHERE ì ˆ ìµœì í™”

- âœ… ì‹œê°„ ë²”ìœ„ í•„í„°ë¥¼ WHERE ì ˆ ìµœìš°ì„ ìœ¼ë¡œ ë°°ì¹˜
- âœ… ë³µí•© ì¸ë±ìŠ¤ í™œìš©ì„ ìœ„í•œ í•„í„° ìˆœì„œ: `ne` â†’ `cellid` â†’ `peg_name` â†’ `host`
- âœ… IN ì ˆì—ì„œ ë¹ˆ ë¦¬ìŠ¤íŠ¸ ì²´í¬ ì¶”ê°€
- âœ… SQL ì¸ì ì…˜ ë°©ì§€ë¥¼ ìœ„í•œ ì»¬ëŸ¼ëª… ê²€ì¦

### 2. SELECT ì ˆ ìµœì í™”

- âœ… í•„ìš”í•œ ì»¬ëŸ¼ë§Œ ì¡°íšŒ (SELECT \* ë°©ì§€)
- âœ… ì»¬ëŸ¼ ë³„ì¹­ ì‚¬ìš©ìœ¼ë¡œ ê²°ê³¼ ì¼ê´€ì„± ë³´ìž¥
- âœ… ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ ë°ì´í„° ë³€í™˜

### 3. ORDER BY ë° LIMIT ìµœì í™”

- âœ… ì‹œê°„ìˆœ ì •ë ¬ë¡œ ì¸ë±ìŠ¤ í™œìš©
- âœ… LIMITìœ¼ë¡œ ê²°ê³¼ ì§‘í•© í¬ê¸° ì œí•œ
- âœ… ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ ì‹œ ì„±ëŠ¥ í–¥ìƒ

## ðŸ“ˆ ì˜ˆìƒ ì„±ëŠ¥ ê°œì„  íš¨ê³¼

| ìµœì í™” í•­ëª©          | ì˜ˆìƒ ê°œì„  íš¨ê³¼           | ì ìš© ìƒí™©          |
| -------------------- | ------------------------ | ------------------ |
| **ì¸ë±ìŠ¤ ìµœì í™”**    | 50-80% ì¿¼ë¦¬ ì‹œê°„ ë‹¨ì¶•    | ëª¨ë“  ì¿¼ë¦¬          |
| **í•„í„° ìˆœì„œ ìµœì í™”** | 10-20% ì¿¼ë¦¬ ì‹œê°„ ë‹¨ì¶•    | ë³µí•© í•„í„° ì¿¼ë¦¬     |
| **ì»¬ëŸ¼ ì„ íƒ ìµœì í™”** | 5-15% ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ | ëŒ€ìš©ëŸ‰ ê²°ê³¼ ì§‘í•©   |
| **LIMIT ìµœì í™”**     | 90% ì´ìƒ ê°œì„             | ëŒ€ìš©ëŸ‰ ë°ì´í„° ì¡°íšŒ |

## âš¡ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

### 1. ì¿¼ë¦¬ ì‹¤í–‰ ì‹œê°„ ì¶”ì 

- 100ms ì´ˆê³¼ ì¿¼ë¦¬ì— ëŒ€í•œ ìžë™ ê²½ê³ 
- ì‹¤í–‰ ì‹œê°„ ë¡œê¹…ìœ¼ë¡œ ì„±ëŠ¥ íŠ¸ë Œë“œ ëª¨ë‹ˆí„°ë§

### 2. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”

- RealDictRow â†’ dict ë³€í™˜ ìµœì í™”
- ì»¤ë„¥ì…˜ í’€ í™œìš©ìœ¼ë¡œ ì—°ê²° ì˜¤ë²„í—¤ë“œ ê°ì†Œ

### 3. ì¸ë±ìŠ¤ íš¨ìœ¨ì„± ê²€ì¦

```sql
-- ì¸ë±ìŠ¤ ì‚¬ìš©ëŸ‰ í™•ì¸
EXPLAIN (ANALYZE, BUFFERS)
SELECT datetime, peg_name, value, ne, cellid
FROM summary
WHERE datetime >= '2025-01-01 09:00:00'
  AND datetime < '2025-01-01 18:00:00'
  AND ne = 'nvgnb#10001'
  AND cellid IN ('cell_001', 'cell_002')
ORDER BY datetime
LIMIT 1000;
```

## ðŸš€ êµ¬í˜„ ìƒíƒœ

### âœ… ì™„ë£Œëœ ìµœì í™”

1. **ì¿¼ë¦¬ êµ¬ì¡° ìµœì í™”**: WHERE ì ˆ ìˆœì„œ, SELECT ì ˆ ìµœì í™”
2. **ì¸ë±ìŠ¤ í™œìš© ìµœì í™”**: ë³µí•© ì¸ë±ìŠ¤ë¥¼ ê³ ë ¤í•œ í•„í„° ìˆœì„œ
3. **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**: ì‹¤í–‰ ì‹œê°„ ì¶”ì  ë° ê²½ê³  ì‹œìŠ¤í…œ
4. **ë©”ëª¨ë¦¬ ìµœì í™”**: íš¨ìœ¨ì ì¸ ë°ì´í„° ë³€í™˜ ë° ì²˜ë¦¬

### ðŸ”„ ì¶”ê°€ ìµœì í™” ê³ ë ¤ì‚¬í•­

1. **íŒŒí‹°ì…”ë‹**: ì‹œê°„ ê¸°ë°˜ í…Œì´ë¸” íŒŒí‹°ì…”ë‹ (ì›”ë³„/ì¼ë³„)
2. **ì¿¼ë¦¬ ìºì‹±**: ìžì£¼ ì‚¬ìš©ë˜ëŠ” ì¿¼ë¦¬ ê²°ê³¼ ìºì‹±
3. **ë°°ì¹˜ ì²˜ë¦¬**: ëŒ€ìš©ëŸ‰ ë°ì´í„° ì¡°íšŒ ì‹œ ì²­í¬ ë‹¨ìœ„ ì²˜ë¦¬
4. **ì½ê¸° ì „ìš© ë³µì œë³¸**: ì½ê¸° ë¶€í•˜ ë¶„ì‚°ì„ ìœ„í•œ ìŠ¬ë ˆì´ë¸Œ DB í™œìš©

## ðŸ“‹ ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì¼ì¼ ëª¨ë‹ˆí„°ë§

- [ ] ì¿¼ë¦¬ ì‹¤í–‰ ì‹œê°„ 100ms ì´ˆê³¼ ê±´ìˆ˜ í™•ì¸
- [ ] ì¸ë±ìŠ¤ ì‚¬ìš©ë¥  ëª¨ë‹ˆí„°ë§
- [ ] ì»¤ë„¥ì…˜ í’€ ìƒíƒœ í™•ì¸

### ì£¼ê°„ ìµœì í™”

- [ ] ëŠë¦° ì¿¼ë¦¬ ë¡œê·¸ ë¶„ì„
- [ ] ì¸ë±ìŠ¤ íš¨ìœ¨ì„± ê²€í† 
- [ ] í…Œì´ë¸” í†µê³„ ì—…ë°ì´íŠ¸

### ì›”ê°„ ê²€í† 

- [ ] íŒŒí‹°ì…”ë‹ í•„ìš”ì„± ê²€í† 
- [ ] ì¸ë±ìŠ¤ ìž¬êµ¬ì„± ê³ ë ¤
- [ ] ìš©ëŸ‰ ê³„íš ë° í™•ìž¥ì„± ê²€í† 
